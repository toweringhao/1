单例模式(Singleton)的常见应用场景

单例模式(Singleton)也叫单态模式，是设计模式中最为简单的一种模式，甚至有些模式大师都不称其为模式，称其为一种实现技巧，因为设计模式讲究对象之间的关系的抽象，而单例模式只有自己一个对象，也因此有些设计大师并把把其称为设计模式之一。

对单例模式不了解的可以先看下：http://terrylee.cnblogs.com/archive/2005/12/09/293509.html 

1. Windows的Task Manager（任务管理器）就是很典型的单例模式（这个很熟悉吧），想想看，是不是呢，你能打开两个windows task manager吗？ 不信你自己试试看哦~ 

2. windows的Recycle Bin（回收站）也是典型的单例应用。在整个系统运行过程中，回收站一直维护着仅有的一个实例。

3. 网站的计数器，一般也是采用单例模式实现，否则难以同步。

4. 应用程序的日志应用，一般都何用单例模式实现，这一般是由于共享的日志文件一直处于打开状态，因为只能有一个实例去操作，否则内容不好追加。

5. Web应用的配置对象的读取，一般也应用单例模式，这个是由于配置文件是共享的资源。

6. 数据库连接池的设计一般也是采用单例模式，因为数据库连接是一种数据库资源。数据库软件系统中使用数据库连接池，主要是节省打开或者关闭数据库连接所引起的效率损耗，这种效率上的损耗还是非常昂贵的，因为何用单例模式来维护，就可以大大降低这种损耗。

7. 多线程的线程池的设计一般也是采用单例模式，这是由于线程池要方便对池中的线程进行控制。

8. 操作系统的文件系统，也是大的单例模式实现的具体例子，一个操作系统只能有一个文件系统。

9. HttpApplication 也是单位例的典型应用。熟悉ASP.Net(IIS)的整个请求生命周期的人应该知道HttpApplication也是单例模式，所有的HttpModule都共享一个HttpApplication实例.、

【单例模式与其它模式】
工厂方法模式(factory method模式)：单例模式使用工厂模式来提供自己的实例。
抽象工厂模式(abstract factory模式)：抽象工厂模式可以使用单例模式，将具体工厂类设计成单例类。
建造者模式(Builder模式)：建造模式可以将具体建造类设计成单例模式。

【单例模式中主要角色】
Singleton 定义一个Instance操作，允许客户访问它的唯一实例。Instance是一个类方法。负责创建它的唯一的实例。

【单例模式的优点】
1、对唯一实例的受控访问
2、缩小命名空间 单例模式是对全局变量的一种改进。它避免了那些存储唯一实例的全局变量污染命名空间
3、允许对操作和表示的精华 单例类可以有子类。而且用这个扩展类的实例来配置一个应用是很容易的。你可以用你所需要的类的实例在运行时刻配置应用。
4、允许可变数目的实例（多例模式）
5、比类操作更灵活

【单例模式适用场景】
1、当类只能有一个实例而且客户可以从一个众所周知的访问点访问它时
2、当这个唯一实例应该是通过子类化可扩展的。并且用户应该无需更改代码就能使用一个扩展的实例时。

<?php
/**
 * 单例模式 2015-10-09
 * 1.目的
 * 单例模式是对全局变量的一种改进。它避免了那些存储唯一实例的全局变量污染命名空间
 * 2.使用场景
 * 2.1 当类只能有一个实例而且客户可以从一个众所周知的访问点访问它时
 * 2.2 当这个唯一实例应该是通过子类化可扩展的。并且用户应该无需更改代码就能使用一个扩展的实例时
 */

/**
 * 单例类
 */
class Singleton 
{ 
    /**
     * 静态成品变量 保存全局实例
     */
    private static  $_instance = NULL;
 
    /**
     * 私有化默认构造方法，保证外界无法直接实例化
     */
    private function __construct() 
    {

    }
 
    /**
     * 静态工厂方法，返还此类的唯一实例
     */
    public static function getInstance() 
    {
        if (is_null(self::$_instance)) {
            self::$_instance = new Singleton();
        } 
        return self::$_instance;
    }
 
    /**
     * 防止用户克隆实例
     */
    public function __clone()
    {
        die('Clone is not allowed.' . E_USER_ERROR);
    }
 
    /**
     * 测试用方法
     */
    public function test() 
    {
        echo 'Singleton Test!';
    } 
}
 
/**
 * 客户端
 */
class Client 
{ 
    /**
     * Main program.
     */
    public static function main() 
    {
        $instance = Singleton::getInstance();
        $instance->test();
    }
}
 
Client::main();
?>
